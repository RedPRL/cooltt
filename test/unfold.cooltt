import prelude

/-
  In this file, we demonstrate some examples of low-level declarations that a
  high-level interface for conditional opacity and unfolding could be
  elaborated to.
-/

/-
  opaque def + : nat â†’ nat â†’ nat :=
    elim [
    | zero => n => n
    | suc {_ => ih} => n => suc {ih n}
    ]
-/

axiom +/unf : ð•€
def +/def (_ : [+/unf=1]) : nat â†’ nat â†’ nat :=
  elim [
  | zero => n => n
  | suc {_ => ih} => n => suc {ih n}
  ]

axiom + : sub {nat â†’ nat â†’ nat} {+/unf=1} {+/def _}

#normalize +

/-
  opaque def +R : (x : nat) â†’ path nat {+ x 0} x unfolding + :=
    elim [
    | zero =>
      _ => 0
    | suc {y => ih} =>
      i => suc {ih i}
    ]
-/

axiom +R/unf : ð•€
axiom +R/unf/+ : [+R/unf â‰¤ +/unf]

def +R/def (_ : [+R/unf=1]) : (x : nat) â†’ path nat {+ x 0} x :=
  elim [
  | zero =>
    _ => 0
  | suc {y => ih} =>
    i => suc {ih i}
  ]

axiom +/R : sub {(x : nat) â†’ path nat {+ x 0} x} {+R/unf=1} {+R/def _}

#normalize +/R
