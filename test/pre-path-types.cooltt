/-
  In this file, the tests for the path type are rewritten in terms of the
  primitives that the path-type decodes to: the dependent product over the
  interval, and the cubical subtypes.
-/

def myrefl : {
  (A : type) (a : A) â†’ (i : ğ•€) â†’ sub A {âˆ‚ i} [âˆ‚ i â‡’ a]
} = {
  A a i â‡’ a
}


def funext : {
  (A : type) (B : type) (f : (x : A) â†’ B) (g : (x : A) â†’ B)
  (h : (x : A) (i : ğ•€) â†’ sub B {âˆ‚ i} [i=0 â‡’ f x | i=1 â‡’ g x])
  â†’ (i : ğ•€) â†’ sub {(x : A) â†’ B} {âˆ‚ i} [i=0 â‡’ f | i=1 â‡’ g]
} = {
  A B f g h i x â‡’
  h x i
}

def pairext : {
  (A : type) (B : type) (p : (x : A) Ã— B) (q : (x : A) Ã— B)
  (h :
     (x : (i : ğ•€) â†’ sub A {âˆ‚ i} [i=0 â‡’ fst p | i=1 â‡’ fst q]) Ã—
     (i : ğ•€) â†’ sub B {âˆ‚ i} [i=0 â‡’ snd p | i=1 â‡’ snd q])
  â†’ (i : ğ•€) â†’ sub {(x : A) Ã— B} {âˆ‚ i} [i=0 â‡’ p | i=1 â‡’ q]
} = {
  A B p q h i â‡’
  [ {fst h} i
  , {snd h} i
  ]
}

normalize myrefl
normalize funext
normalize pairext
