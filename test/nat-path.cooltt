def symm : {
  (A : univ) (p : ð•€ â†’ A) â†’ path {\_ => A} {p 1} {p 0}
}= {
  \A p i =>
  hcom A 0 1 {\j _ =>
    [ j=0 \/ i=1 => p 0
    | i=0 => p j
    ]
  }
}

def trans : {
  (A : univ) (p : ð•€ â†’ A) (q : (i : ð•€) â†’ sub A {i=0} {p 1}) â†’ path {\_ => A} {p 0} {q 1}
} = {
  \A p q i =>
  hcom A 0 1 {\j _ =>
    [ j=0 \/ i=0 => p i
    | i=1 => q j
    ]
  }
}

-- def trans-assoc : {
--   (A : univ) (s : A) (t : A) (u : A) (v : A)
--   (p : Id A s t) (q : Id A t u) (r : Id A u v)
--   â†’ Id
--       {Id A s v}
--       {trans A s u v {trans A s t u p q} r}
--       {trans A s t v p {trans A t u v q r}}
-- } = {
--   \A s t u v p =>
--   elim p @ {s t p =>
--     (q : Id A t u) (r : Id A u v)
--     â†’ Id
--         {Id A s v}
--         {trans A s u v {trans A s t u p q} r}
--         {trans A s t v p {trans A t u v q r}}
--   } [
--   | refl => \q r => refl
--   ]
-- }

-- def trans-left-unit : {
--   (A : univ) (x : A) (y : A) (p : Id A x y)
--   â†’ Id {Id A x y} {trans A x x y refl p} p
-- } = {
--   \A x y p => refl
-- }

-- def trans-right-unit : {
--   (A : univ) (x : A) (y : A) (p : Id A x y)
--   â†’ Id {Id A x y} {trans A x y y p refl} p
-- } = {
--   \A x y p =>
--   elim p @ {x y p => Id {Id A x y} {trans A x y y p refl} p} [
--   | refl => refl
--   ]
-- }

-- def trans-symm-refl : {
--   (A : univ) (x : A) (y : A) (p : Id A x y)
--   â†’ Id {Id A x x} {trans A x y x p {symm A x y p}} refl
-- } = {
--   \A x y p =>
--   elim p @ {x y p =>
--     Id {Id A x x} {trans A x y x p {symm A x y p}} refl
--   } [
--   | refl => refl
--   ]
-- }

-- def cong : {
--   (A : univ) (B : univ) (f : A â†’ B)
--   (x : A) (y : A) (p : Id A x y)
--   â†’ Id B {f x} {f y}
-- } = {
--   \A B f x y p =>
--   elim p @ {u v _ => Id B {f u} {f v}} [
--   | refl => refl
--   ]
-- }

normalize trans
normalize symm

def + : nat â†’ nat â†’ nat = {
  \elim [
  | zero => \n => n
  | suc {_ => ih} => \n => suc {ih n}
  ]
}

def +-right-unit : (x : nat) â†’ path {\_ => nat} {+ x 0} x = {
  \elim [
  | zero =>
    \_ => 0
  | suc {y => ih} =>
    \i => suc {ih i}
  ]
}

def +-left-unit : (x : nat) â†’ path {\_ => nat} {+ 0 x} x = {
  \x _ => x
}

def +-suc-r : (x : nat) (y : nat) â†’ path {\_ => nat} {+ x {suc y}} {suc {+ x y}} = {
  \elim [
  | zero =>
    \x i => {suc x}
  | suc {x => ih} =>
    \y i => suc {ih y i}
  ]
}

def +-comm : (x : nat) (y : nat) â†’ path {\_ => nat} {+ y x} {+ x y} = {
  \elim [
  | zero => +-right-unit
  | suc {y => ih} =>
    \z =>
    trans nat {+-suc-r z y} {\j => suc {ih z j}}
  ]
}

def +-assoc : {
  (x : nat) (y : nat) (z : nat) â†’
  path {\_ => nat} {+ {+ x y} z} {+ x {+ y z}}
} = {
  \elim [
  | zero => \y z i => + y z
  | suc {x => ih} => \y z i => suc {ih y z i}
  ]
}

def test : {
  (p : ð•€ â†’ nat) â†’ (i : ð•€) â†’ nat
} = {
  \p i =>
  elim {symm nat p i} @ {_ => nat} [
  | zero => zero
  | suc {x => ih} => zero
  ]
}
